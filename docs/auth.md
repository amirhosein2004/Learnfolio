# احراز هویت در Learnfolio

## روش‌های احراز هویت
- ورود با ایمیل یا شماره موبایل و رمز عبور و یا کد OTP
- ثبت نام با کد OTP به شماره یا لینک تایید به ایمیل

## فرآیندها
- **ارسال OTP:** کاربر ایمیل یا شماره موبایل خود را وارد می‌کند. اگر کاربر وجود داشته باشد، OTP ورود ارسال می‌شود؛ در غیر این صورت، OTP ثبت‌نام ارسال می‌شود یا لینک تایید ایمیل
- **تأیید OTP:** کاربر کد را وارد می‌کند و سیستم اعتبارسنجی و انقضای آن را بررسی می‌کند.
- **ورود با رمز عبور:** کاربر می‌تواند با ایمیل/شماره و رمز عبور نیز وارد شود.

## پیاده‌سازی
- مدل کاربر سفارشی با فیلدهای ایمیل و شماره موبایل
- backend احراز هویت سفارشی (EmailOrPhoneBackend)
- serializerهای DRF برای اعتبارسنجی هویت و OTP
- viewهای API برای ارسال و تأیید OTP

## امنیت
- محدودیت نرخ درخواست (throttling) برای جلوگیری از سوءاستفاده
- انقضای OTP (پیش‌فرض ۲ دقیقه)

## کپچا Turnstile

در این پروژه، برای افزایش امنیت و جلوگیری از حملات ربات‌ها، کپچا Turnstile پیاده‌سازی شده است.
فعال یا غیرفعال بودن کپچا با متغیر محیطی `TURNSTILE_ENABLED` کنترل می‌شود:

- اگر مقدار `TURNSTILE_ENABLED` برابر `true` باشد، کپچا فعال است و کاربران باید آن را تکمیل کنند.
- اگر مقدار `TURNSTILE_ENABLED` برابر `false` باشد، کپچا غیرفعال است (مناسب فقط برای توسعه).

کلید مخفی کپچا نیز باید در متغیر `TURNSTILE_SECRET_KEY` قرار گیرد.

برای اطلاعات بیشتر درباره متغیرهای محیطی، به [env_vars.md](./env_vars.md) مراجعه کنید.
